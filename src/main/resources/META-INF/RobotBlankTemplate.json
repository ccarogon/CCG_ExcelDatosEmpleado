{"id":"RobotBlankTemplate","robotType":"ROBOT","mainClass":"com.appian.robot.core.template.RobotBlankTemplate","actions":["start","crearExcel","end"],"conditionalActions":[],"fieldLinks":[],"actionDetails":[{"id":"start","implementation":"/**\n\t * Initialize the modules\n\t */\npublic void start() {\n    server = JidokaFactory.getServer();\n    client = IClient.getInstance(this);\n    server.debug(\"Robot inicializado\");\n    /**\n\t\t * Variables de proceso\n\t\t */\n    variables = server.getWorkflowVariables();\n}"},{"id":"crearExcel","implementation":"/**\n\t * Metodo Excel\n\t */\npublic void crearExcel() {\n    IRobotVariable rvn = variables.get(\"Nombre\");\n    IRobotVariable rva = variables.get(\"Apellidos\");\n    //Libro en blanco\n    HSSFWorkbook workbook = new  HSSFWorkbook();\n    //Crear una pestaña en blanco\n    HSSFSheet sheet = workbook.createSheet(\"Datos empleado\");\n    //This data needs to be written (Object[])\n    System.out.println(\"Insertamos datos en el fichero Excel\");\n    Map<String, Object[]> data = new  TreeMap<String, Object[]>();\n    data.put(\"1\", new Object[] { \"ID\", \"NOMBRE\", \"APELLIDOS\" });\n    //data.put(\"2\", new Object[] {1, rvn, rva});\n    data.put(\"3\", new Object[] { 2, \"Juan\", \"Lopez Muñoz\" });\n    data.put(\"4\", new Object[] { 3, \"David\", \"Jaen Perez\" });\n    data.put(\"5\", new Object[] { 4, \"Lucia\", \"Sanchez Perez\" });\n    System.out.println(\"Datos Excel en memoria\");\n    //Interaccionar con los datos y escribir en la pestaña\n    Set<String> keyset = data.keySet();\n    int rownum = 0;\n    for (String key : keyset) {\n        Row row = sheet.createRow(rownum++);\n        Object[] objArr = data.get(key);\n        int cellnum = 0;\n        for (Object obj : objArr) {\n            Cell cell = row.createCell(cellnum++);\n            if (obj instanceof String)\n                cell.setCellValue((String) obj);\n            else if (obj instanceof Integer)\n                cell.setCellValue((Integer) obj);\n            System.out.println(\"Insertamos datos\");\n        }\n    }\n    try {\n        //Escribir el libro en el fichero\n        FileOutputStream out = new  FileOutputStream(new  File(\"C:\\\\Users\\\\ccarogon\\\\Documents\\\\RPA\\\\Result\\\\Datos_empleados.xls\"));\n        workbook.write(out);\n        out.close();\n        System.out.println(\"Datos_empleados.xls escrito satisfactoriamente en disco.\");\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n}"},{"id":"end","implementation":"/**\n\t * End.\n\t */\npublic void end() {\n}"}],"conditionalActionDetails":[],"sdkMethods":[]}